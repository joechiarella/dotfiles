SELECT f0."id", f0."folder_id", f0."tenant_id", f0."source_video_id", f0."source_image_id", f0."post_id", f0."gif_id", f0."clip_asset_id", f0."audio_id", f0."generator_overlay_id", f0."inserted_at", f0."updated_at", s4."id", s4."name", s4."description", s4."deleted_at", s4."expiration_date", s4."processing_status", s4."source_image_xray_tag_json", s4."source_image_xray_tag_json_ingested_at", s4."total_rekognition_label_count", s4."unique_rekognition_label_count", s4."tenant_id", s4."created_by_id", s4."deleted_by_id", s4."original_gif_file_variant_id", s4."preview_gif_file_variant_id", s4."standardized_gif_file_variant_id", s4."inserted_at", s4."updated_at", s3."id", s3."tenant_id", s3."created_by_id", s3."deleted_by", s3."processing_status", s3."name", s3."description", s3."deleted_at", s3."expiration_date", s3."first_video_frame_offset_ms", s3."segment_analysis_version", s3."thumbnail_tile_width", s3."thumbnail_tile_height", s3."thumbnail_tile_count", s3."timeline_thumbnail_tile_width", s3."timeline_thumbnail_tile_height", s3."timeline_thumbnail_tile_count", s3."medium_hls_progress", s3."thumbnail_progress", s3."standardization_progress", s3."timeline_thumbnails_gif_file_variant_id", s3."thumbnails_gif_file_variant_id", s3."original_gif_file_variant_id", s3."standardized_gif_file_variant_id", s3."small_hls_stream_variant_id", s3."medium_hls_stream_variant_id", s3."large_hls_stream_variant_id", s3."source_video_xray_tag_json_file_id", s3."source_video_xray_tag_segment_json_file_id", s3."source_video_shot_segment_json_file_id", s3."source_video_clip_model_embedding_json_file_id", s3."source_video_audio_transcript_embedding_json_file_id", s3."source_video_audio_transcript_vtt_file_id", s3."source_video_xray_tag_segment_json_ingested_at", s3."source_video_shot_segment_json_ingested_at", s3."source_video_clip_model_embedding_json_ingested_at", s3."source_video_audio_transcript_embedding_json_ingested_at", s3."source_video_clip_model_processed_at", s3."audio_transcript_language", s3."audio_transcript_summary", s3."audio_transcript_embedding_v1", s3."audio_transcript_failed_quality", s3."inserted_at", s3."updated_at", g2."id", g2."tenant_id", g2."legacy_id", g2."name", g2."description", g2."deleted_at", g2."exclude_from_library", g2."expiration_date", g2."gif_file_variant_dictionary_id", g2."created_by_id", g2."deleted_by_id", g2."generator_version_id", g2."editor_version_id", g2."highlight_id", g2."inserted_at", g2."updated_at" FROM "folder_media" AS f0 INNER JOIN (SELECT sf0."id" AS "id", row_number() OVER "media_partition" AS "row_number" FROM "folder_media" AS sf0 WHERE (NOT ((sf0."source_video_id" IS NULL) AND (sf0."source_image_id" IS NULL))) AND (sf0."folder_id" = ANY($1)) WINDOW "media_partition" AS (PARTITION BY sf0."folder_id" ORDER BY sf0."inserted_at")) AS s1 ON (f0."id" = s1."id") AND (s1."row_number" <= 1) LEFT OUTER JOIN "gifs" AS g2 ON g2."id" = f0."gif_id" LEFT OUTER JOIN "source_videos" AS s3 ON s3."id" = f0."source_video_id" LEFT OUTER JOIN "source_images" AS s4 ON s4."id" = f0."source_image_id" WHERE (f0."folder_id" = ANY($2) AND (f0."tenant_id" = $3))